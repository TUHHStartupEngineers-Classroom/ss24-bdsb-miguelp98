{
  "hash": "27af1ae8874eed67167be5f5cd99ce28",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Miguel Peñate\"\ndate: \"2024-05-21\"\nformat:\n  html:\n    code-fold: true\n    self-contained: false\n---\n\n::: {.cell hash='03_data_wrangling_cache/html/plot_b12f786cb9db7444a4e54eb41ed71698'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\nsetwd(\"C:/Users/migue/Desktop/Hamburg/TUHH/ss24-bdsb-miguelp98/01_raw_data\")\n# Cargar librerías necesarias\nlibrary(tidyverse)\nlibrary(vroom)\nlibrary(data.table)\nlibrary(tictoc)\n\n# Definir los tipos de columnas para cada archivo\n\n# assignee.tsv\ncol_types_assignee <- list(\n  id = col_character(),\n  type = col_character(),\n  organization = col_character()\n)\n\n# patent.tsv\ncol_types_patent <- list(\n  id = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  num_claims = col_integer()\n)\n\n# patent_assignee.tsv\ncol_types_patent_assignee <- list(\n  patent_id = col_character(),\n  assignee_id = col_character()\n)\n\n# uspc.tsv\ncol_types_uspc <- list(\n  patent_id = col_character(),\n  mainclass_id = col_character(),\n  sequence = col_integer()\n)\n\n# Importar los datos\n\n# assignee.tsv\nassignee_tbl <- vroom(\n  file       = \"assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_assignee,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\nsetDT(assignee_tbl)\n\n# patent.tsv\npatent_tbl <- vroom(\n  file       = \"patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_patent,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\nsetDT(patent_tbl)\n\n# patent_assignee.tsv\npatent_assignee_tbl <- vroom(\n  file       = \"patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_patent_assignee,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\nsetDT(patent_assignee_tbl)\n\n# uspc.tsv\nuspc_tbl <- vroom(\n  file       = \"uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_uspc,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\nsetDT(uspc_tbl)\n\n# Renombrar columnas para consistencia\nsetnames(patent_assignee_tbl, old = c(\"patent_id\", \"assignee_id\"), new = c(\"id\", \"assignee_id\"))\nsetnames(uspc_tbl, old = \"patent_id\", new = \"id\")\n\n# Combinar los datos paso a paso\ncombined_data <- merge(patent_tbl, patent_assignee_tbl, by = \"id\")\ncombined_data <- merge(combined_data, assignee_tbl, by.x = \"assignee_id\", by.y = \"id\")\ncombined_data <- merge(combined_data, uspc_tbl, by = \"id\")\n\n# Visualizar una muestra de los datos combinados\ncombined_data %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 802,177\n#> Columns: 8\n#> $ id           <chr> \"8621662\", \"8621663\", \"8621663\", \"8621666\", \"8621666\", \"8…\n#> $ assignee_id  <chr> \"org_aTMUEAbUvQuADfnSfudQ\", \"org_FfZ2sonhh4RvKY8vYp2B\", \"…\n#> $ date         <date> 2014-01-07, 2014-01-07, 2014-01-07, 2014-01-07, 2014-01-…\n#> $ num_claims   <int> 11, 6, 6, 7, 7, 21, 21, 21, 21, 21, 19, 19, 19, 19, 8, 15…\n#> $ type         <chr> \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2…\n#> $ organization <chr> \"Hamilton Sundstrand Space Systems International, Inc.\", …\n#> $ mainclass_id <chr> \"2\", \"2\", \"351\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", \"2\", …\n#> $ sequence     <int> 0, 0, 1, 0, 1, 0, 1, 3, 2, 4, 0, 2, 1, 3, 0, 0, 2, 3, 1, …\n```\n:::\n\n```{.r .cell-code}\n# Contar las patentes por organización\npatent_count <- combined_data[, .N, by = organization][order(-N)][1:10]\n\n# Mostrar el resultado\nprint(patent_count)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                                    organization     N\n#>                                          <char> <int>\n#>  1: International Business Machines Corporation 19056\n#>  2:               Samsung Electronics Co., Ltd. 14523\n#>  3:                      Canon Kabushiki Kaisha  9467\n#>  4:                            Sony Corporation  8372\n#>  5:                       QUALCOMM Incorporated  7322\n#>  6:                       Microsoft Corporation  7195\n#>  7:                    Kabushiki Kaisha Toshiba  6957\n#>  8:                                 Google Inc.  6082\n#>  9:                         LG Electronics Inc.  5694\n#> 10:                       Panasonic Corporation  5641\n```\n:::\n\n```{.r .cell-code}\n# Filtrar patentes de agosto de 2014 y contar por organización\naugust_patents <- combined_data[format(date, \"%Y-%m\") == \"2014-08\", .N, by = organization][order(-N)][1:10]\n\n# Mostrar el resultado\nprint(august_patents)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>                                    organization     N\n#>                                          <char> <int>\n#>  1: International Business Machines Corporation  1810\n#>  2:               Samsung Electronics Co., Ltd.  1223\n#>  3:                       Microsoft Corporation   779\n#>  4:                      Canon Kabushiki Kaisha   772\n#>  5:                            Sony Corporation   596\n#>  6:                       QUALCOMM Incorporated   591\n#>  7:                                 Google Inc.   566\n#>  8:                    Kabushiki Kaisha Toshiba   544\n#>  9:        Hon Hai Precision Industry Co., Ltd.   514\n#> 10:                                  Apple Inc.   501\n```\n:::\n\n```{.r .cell-code}\n# Filtrar datos y contar las principales clases tecnológicas\ntop_tech_sectors <- combined_data[, .N, by = mainclass_id][order(-N)][1:5]\n\n# Mostrar el resultado\nprint(top_tech_sectors)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>    mainclass_id     N\n#>          <char> <int>\n#> 1:          257 41500\n#> 2:          455 29419\n#> 3:          370 25628\n#> 4:          438 20372\n#> 5:          709 18345\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}